<div class="d-flex justify-content-between align-items-center mb-4">
  <h4>{{ isEdit ? 'Edit' : 'Create New' }} Prescription</h4>
  <button class="btn btn-outline-secondary" (click)="onCancel()">
    ‚Üê Back to List
  </button>
</div>

<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-body">
        <!-- Loading Spinner -->
        <div *ngIf="loading && isEdit" class="text-center py-4">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
          {{ errorMessage }}
        </div>

        <!-- Success Message -->
        <div *ngIf="successMessage" class="alert alert-success" role="alert">
          {{ successMessage }}
        </div>

        <!-- Prescription Form -->
        <form *ngIf="!loading || !isEdit" (ngSubmit)="onSubmit()" #prescriptionForm="ngForm">
          <div class="row g-3">
            <!-- Prescription Date -->
            <div class="col-md-6">
              <label for="prescriptionDate" class="form-label">Prescription Date *</label>
              <input 
                type="date" 
                class="form-control" 
                id="prescriptionDate"
                [(ngModel)]="prescription.prescriptionDate" 
                name="prescriptionDate"
                required>
            </div>

            <!-- Next Visit Date -->
            <div class="col-md-6">
              <label for="nextVisitDate" class="form-label">Next Visit Date</label>
              <input 
                type="date" 
                class="form-control" 
                id="nextVisitDate"
                [(ngModel)]="prescription.nextVisitDate" 
                name="nextVisitDate">
            </div>

            <!-- Patient Name -->
            <div class="col-md-6">
              <label for="patientName" class="form-label">Patient Name *</label>
              <input 
                type="text" 
                class="form-control" 
                id="patientName"
                [(ngModel)]="prescription.patientName" 
                name="patientName"
                required
                placeholder="Enter patient name">
            </div>

            <!-- Patient Age -->
            <div class="col-md-3">
              <label for="patientAge" class="form-label">Patient Age *</label>
              <input 
                type="number" 
                class="form-control" 
                id="patientAge"
                [(ngModel)]="prescription.patientAge" 
                name="patientAge"
                required
                min="0"
                max="150"
                placeholder="Age">
            </div>

            <!-- Patient Gender -->
            <div class="col-md-3">
              <label for="patientGender" class="form-label">Gender *</label>
              <select 
                class="form-select" 
                id="patientGender"
                [(ngModel)]="prescription.patientGender" 
                name="patientGender"
                required>
                <option value="">Select Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <!-- Diagnosis -->
            <div class="col-12">
              <label for="diagnosis" class="form-label">Diagnosis</label>
              <textarea 
                class="form-control" 
                id="diagnosis"
                [(ngModel)]="prescription.diagnosis" 
                name="diagnosis"
                rows="3"
                placeholder="Enter diagnosis details"></textarea>
            </div>

            <!-- Medicines -->
            <div class="col-12">
              <label for="medicines" class="form-label">Medicines</label>
              <textarea 
                class="form-control" 
                id="medicines"
                [(ngModel)]="prescription.medicines" 
                name="medicines"
                rows="4"
                placeholder="Enter prescribed medicines and dosage"></textarea>
            </div>

            <!-- Form Actions -->
            <div class="col-12 mt-4">
              <div class="d-flex gap-2 justify-content-end">
                <button type="button" class="btn btn-secondary" (click)="onCancel()">
                  Cancel
                </button>
                <button 
                  type="submit" 
                  class="btn btn-primary"
                  [disabled]="loading">
                  <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                  {{ isEdit ? 'Update' : 'Create' }} Prescription
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>